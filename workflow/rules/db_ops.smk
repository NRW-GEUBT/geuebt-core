# Set of CRUD operation for mongoDB


#TODO
rule mongo_pull_clusters:
    output:
        clusters="db_data/{species}/clusters.tsv",
        subclusters="db_data/{species}/subclusters.tsv",
    params:
        organism=lambda w: w.species,
    shell:
        """
        echo "sample\tcluster_name\n" > {output.clusters}
        echo "sample\tcluster_name\n" > {output.subclusters}
        """


#TODO
rule mongo_pull_allele_profiles:
    output:
        profiles="db_data/{species}/profiles.tsv",
    params:
        organism=lambda w: w.species,
    shell:
        """
        echo "#FILE	lmo0001.fasta	lmo0002.fasta	lmo0003.fasta	lmo0005.fasta	lmo0006.fasta	lmo0007.fasta	lmo0008.fasta	lmo0009.fasta	lmo0012.fasta	lmo0013.fasta	lmo0014.fasta	lmo00DB.fasta	lmo0018.fasta	lmo0020.fasta	lmo0021.fasta	lmo0022.fasta	lmo0024.fasta	lmo0025.fasta	lmo0026.fasta	lmo0027.fasta	lmo0029.fasta	lmo0030.fasta	lmo0031.fasta	lmo0033.fasta	lmo0034.fasta	lmo0035.fasta	lmo0042.fasta	lmo0044.fasta	lmo0045.fasta	lmo0046.fasta	lmo0048.fasta	lmo0051.fasta	lmo0052.fasta	lmo0053.fasta	lmo0054.fasta	lmo0055.fasta	lmo0056.fasta	lmo0075.fasta	lmo0076.fasta	lmo0077.fasta	lmo0078.fasta	lmo0088.fasta	lmo0096.fasta	lmo0097.fasta	lmo0098.fasta	lmo0099.fasta	lmo0102.fasta	lmo0103.fasta	lmo0105.fasta	lmo0107.fasta	lmo0109.fasta	lmo0110.fasta	lmo0111.fasta	lmo0113.fasta	lmo0114.fasta	lmo0115.fasta	lmo01DB.fasta	lmo0131.fasta	lmo0132.fasta	lmo0133.fasta	lmo0134.fasta	lmo0135.fasta	lmo0136.fasta	lmo0137.fasta	lmo0152.fasta	lmo0153.fasta	lmo0155.fasta	lmo0158.fasta	lmo0DB2.fasta	lmo0DB3.fasta	lmo0DB4.fasta	lmo0DB7.fasta	lmo0DB9.fasta	lmo0176.fasta	lmo0177.fasta	lmo0185.fasta	lmo0188.fasta	lmo0189.fasta	lmo0190.fasta	lmo0191.fasta	lmo0192.fasta	lmo0193.fasta	lmo0194.fasta	lmo0195.fasta	lmo0198.fasta	lmo0199.fasta	lmo0201.fasta	lmo0202.fasta	lmo0203.fasta	lmo0205.fasta	lmo0206.fasta	lmo0208.fasta	lmo0210.fasta	lmo0211.fasta	lmo0212.fasta	lmo0213.fasta	lmo0214.fasta	lmo02DB.fasta	lmo0217.fasta	lmo0218.fasta	lmo0219.fasta	lmo0221.fasta	lmo0222.fasta	lmo0223.fasta	lmo0226.fasta	lmo0227.fasta	lmo0229.fasta	lmo0231.fasta	lmo0232.fasta	lmo0233.fasta	lmo0234.fasta	lmo0235.fasta	lmo0238.fasta	lmo0239.fasta	lmo0240.fasta	lmo0241.fasta	lmo0242.fasta	lmo0243.fasta	lmo0245.fasta	lmo0246.fasta	lmo0248.fasta	lmo0249.fasta	lmo0250.fasta	lmo0251.fasta	lmo0256.fasta	lmo0258.fasta	lmo0259.fasta	lmo0261.fasta	lmo0266.fasta	lmo0267.fasta	lmo0268.fasta	lmo0269.fasta	lmo0271.fasta	lmo0272.fasta	lmo0273.fasta	lmo0278.fasta	lmo0281.fasta	lmo0282.fasta	lmo0283.fasta	lmo0284.fasta	lmo0285.fasta	lmo0286.fasta	lmo0287.fasta	lmo0288.fasta	lmo0289.fasta	lmo0290.fasta	lmo0291.fasta	lmo0292.fasta	lmo0293.fasta	lmo0296.fasta	lmo0297.fasta	lmo0298.fasta	lmo0299.fasta	lmo0300.fasta	lmo0314.fasta	lmo03DB.fasta	lmo0317.fasta	lmo0319.fasta	lmo0342.fasta	lmo0343.fasta	lmo0344.fasta	lmo0345.fasta	lmo0346.fasta	lmo0347.fasta	lmo0348.fasta	lmo0349.fasta	lmo0350.fasta	lmo0351.fasta	lmo0352.fasta	lmo0354.fasta	lmo0355.fasta	lmo0356.fasta	lmo0357.fasta	lmo0358.fasta	lmo0359.fasta	lmo0360.fasta	lmo0369.fasta	lmo0370.fasta	lmo0371.fasta	lmo0372.fasta	lmo0374.fasta	lmo0375.fasta	lmo0376.fasta	lmo0377.fasta	lmo0382.fasta	lmo0383.fasta	lmo0386.fasta	lmo0387.fasta	lmo0388.fasta	lmo0391.fasta	lmo0392.fasta	lmo0394.fasta	lmo0398.fasta	lmo0399.fasta	lmo0400.fasta	lmo0401.fasta	lmo0405.fasta	lmo0406.fasta	lmo0407.fasta	lmo0408.fasta	lmo0418.fasta	lmo0424.fasta	lmo0426.fasta	lmo0427.fasta	lmo0428.fasta	lmo0429.fasta	lmo0433.fasta	lmo0437.fasta	lmo0439.fasta	lmo0441.fasta	lmo0442.fasta	lmo0443.fasta	lmo0449.fasta	lmo0450.fasta	lmo0451.fasta	lmo0453.fasta	lmo0454.fasta	lmo0455.fasta	lmo0458.fasta	lmo0480.fasta	lmo0481.fasta	lmo0482.fasta	lmo0483.fasta	lmo0484.fasta	lmo0485.fasta	lmo0486.fasta	lmo0487.fasta	lmo0488.fasta	lmo0489.fasta	lmo0490.fasta	lmo0491.fasta	lmo0494.fasta	lmo0495.fasta	lmo0496.fasta	lmo0509.fasta	lmo0511.fasta	lmo0512.fasta	lmo0515.fasta	lmo05DB.fasta	lmo0517.fasta	lmo0518.fasta	lmo0519.fasta	lmo0521.fasta	lmo0522.fasta	lmo0523.fasta	lmo0524.fasta	lmo0526.fasta	lmo0529.fasta	lmo0530.fasta	lmo0531.fasta	lmo0532.fasta	lmo0533.fasta	lmo0534.fasta	lmo0536.fasta	lmo0539.fasta	lmo0540.fasta	lmo0541.fasta	lmo0543.fasta	lmo0544.fasta	lmo0545.fasta	lmo0546.fasta	lmo0547.fasta	lmo0553.fasta	lmo0555.fasta	lmo0556.fasta	lmo0557.fasta	lmo0558.fasta	lmo0559.fasta	lmo0560.fasta	lmo0562.fasta	lmo0566.fasta	lmo0567.fasta	lmo0568.fasta	lmo0569.fasta	lmo0572.fasta	lmo0573.fasta	lmo0574.fasta	lmo0575.fasta	lmo0578.fasta	lmo0579.fasta	lmo0583.fasta	lmo0584.fasta	lmo0585.fasta	lmo0586.fasta	lmo0587.fasta	lmo0588.fasta	lmo0589.fasta	lmo0590.fasta	lmo0591.fasta	lmo0592.fasta	lmo0593.fasta	lmo0594.fasta	lmo0595.fasta	lmo0596.fasta	lmo0602.fasta	lmo0603.fasta	lmo0604.fasta	lmo0605.fasta	lmo0606.fasta	lmo0607.fasta	lmo0608.fasta	lmo0611.fasta	lmo0612.fasta	lmo0613.fasta	lmo0619.fasta	lmo0621.fasta	lmo0623.fasta	lmo0625.fasta	lmo0626.fasta	lmo0628.fasta	lmo0629.fasta	lmo0636.fasta	lmo0637.fasta	lmo0639.fasta	lmo0640.fasta	lmo0642.fasta	lmo0643.fasta	lmo0644.fasta	lmo0645.fasta	lmo0648.fasta	lmo0649.fasta	lmo0650.fasta	lmo0651.fasta	lmo0654.fasta	lmo0655.fasta	lmo0656.fasta	lmo0657.fasta	lmo0662.fasta	lmo0663.fasta	lmo0665.fasta	lmo0666.fasta	lmo0667.fasta	lmo0673.fasta	lmo0674.fasta	lmo0676.fasta	lmo0677.fasta	lmo0678.fasta	lmo0679.fasta	lmo0680.fasta	lmo0681.fasta	lmo0682.fasta	lmo0683.fasta	lmo0684.fasta	lmo0685.fasta	lmo0687.fasta	lmo0688.fasta	lmo0689.fasta	lmo0690.fasta	lmo0691.fasta	lmo0692.fasta	lmo0693.fasta	lmo0694.fasta	lmo0695.fasta	lmo0696.fasta	lmo0697.fasta	lmo0698.fasta	lmo0699.fasta	lmo0700.fasta	lmo0702.fasta	lmo0703.fasta	lmo0704.fasta	lmo0705.fasta	lmo0706.fasta	lmo0707.fasta	lmo0708.fasta	lmo0710.fasta	lmo0711.fasta	lmo0712.fasta	lmo0713.fasta	lmo0714.fasta	lmo0719.fasta	lmo0721.fasta	lmo0722.fasta	lmo0723.fasta	lmo0724.fasta	lmo0725.fasta	lmo0726.fasta	lmo0728.fasta	lmo0729.fasta	lmo0730.fasta	lmo0742.fasta	lmo0743.fasta	lmo0744.fasta	lmo0745.fasta	lmo0757.fasta	lmo0759.fasta	lmo0761.fasta	lmo0762.fasta	lmo0763.fasta	lmo0764.fasta	lmo0772.fasta	lmo0774.fasta	lmo0775.fasta	lmo0776.fasta	lmo0777.fasta	lmo0778.fasta	lmo0779.fasta	lmo0781.fasta	lmo0782.fasta	lmo0783.fasta	lmo0784.fasta	lmo0785.fasta	lmo0786.fasta	lmo0787.fasta	lmo0788.fasta	lmo0790.fasta	lmo0791.fasta	lmo0793.fasta	lmo0794.fasta	lmo0795.fasta	lmo0796.fasta	lmo0797.fasta	lmo0799.fasta	lmo0802.fasta	lmo0803.fasta	lmo0806.fasta	lmo0807.fasta	lmo0808.fasta	lmo0809.fasta	lmo0810.fasta	lmo0811.fasta	lmo0812.fasta	lmo0813.fasta	lmo0814.fasta	lmo0817.fasta	lmo0818.fasta	lmo0820.fasta	lmo0821.fasta	lmo0822.fasta	lmo0823.fasta	lmo0824.fasta	lmo0825.fasta	lmo0829.fasta	lmo0836.fasta	lmo0837.fasta	lmo0838.fasta	lmo0841.fasta	lmo0843.fasta	lmo0847.fasta	lmo0851.fasta	lmo0852.fasta	lmo0853.fasta	lmo0854.fasta	lmo0855.fasta	lmo0856.fasta	lmo0857.fasta	lmo0858.fasta	lmo0859.fasta	lmo0860.fasta	lmo0862.fasta	lmo0863.fasta	lmo0864.fasta	lmo0866.fasta	lmo0867.fasta	lmo0871.fasta	lmo0872.fasta	lmo0873.fasta	lmo0874.fasta	lmo0875.fasta	lmo0877.fasta	lmo0878.fasta	lmo0879.fasta	lmo0883.fasta	lmo0884.fasta	lmo0885.fasta	lmo0886.fasta	lmo0887.fasta	lmo0888.fasta	lmo0889.fasta	lmo0890.fasta	lmo0891.fasta	lmo0892.fasta	lmo0895.fasta	lmo0896.fasta	lmo0898.fasta	lmo0899.fasta	lmo0900.fasta	lmo0901.fasta	lmo0902.fasta	lmo0903.fasta	lmo0904.fasta	lmo0905.fasta	lmo0906.fasta	lmo0907.fasta	lmo0908.fasta	lmo0909.fasta	lmo0910.fasta	lmo0912.fasta	lmo0913.fasta	lmo0914.fasta	lmo0915.fasta	lmo09DB.fasta	lmo0917.fasta	lmo0918.fasta	lmo0919.fasta	lmo0921.fasta	lmo0922.fasta	lmo0925.fasta	lmo0926.fasta	lmo0927.fasta	lmo0929.fasta	lmo0930.fasta	lmo0931.fasta	lmo0932.fasta	lmo0934.fasta	lmo0935.fasta	lmo0936.fasta	lmo0937.fasta	lmo0943.fasta	lmo0944.fasta	lmo0945.fasta	lmo0946.fasta	lmo0947.fasta	lmo0951.fasta	lmo0953.fasta	lmo0954.fasta	lmo0955.fasta	lmo0956.fasta	lmo0957.fasta	lmo0958.fasta	lmo0959.fasta	lmo0960.fasta	lmo0961.fasta	lmo0962.fasta	lmo0963.fasta	lmo0964.fasta	lmo0966.fasta	lmo0967.fasta	lmo0968.fasta	lmo0970.fasta	lmo0972.fasta	lmo0973.fasta	lmo0974.fasta	lmo0977.fasta	lmo0978.fasta	lmo0979.fasta	lmo0980.fasta	lmo0981.fasta	lmo0982.fasta	lmo0983.fasta	lmo0988.fasta	lmo0989.fasta	lmo0990.fasta	lmo0991.fasta	lmo0992.fasta	lmo0993.fasta	lmo0994.fasta	lmo0995.fasta	lmo0997.fasta	lmo0998.fasta	lmo0999.fasta	lmo1002.fasta	lmo1003.fasta	lmo1007.fasta	lmo1008.fasta	lmo1009.fasta	lmo1010.fasta	lmo1011.fasta	lmo1012.fasta	lmo1013.fasta	lmo1014.fasta	lmo10DB.fasta	lmo1017.fasta	lmo1019.fasta	lmo1020.fasta	lmo1021.fasta	lmo1022.fasta	lmo1023.fasta	lmo1027.fasta	lmo1028.fasta	lmo1029.fasta	lmo1037.fasta	lmo1039.fasta	lmo1040.fasta	lmo1046.fasta	lmo1047.fasta	lmo1049.fasta	lmo1050.fasta	lmo1051.fasta	lmo1052.fasta	lmo1053.fasta	lmo1054.fasta	lmo1055.fasta	lmo1058.fasta	lmo1064.fasta	lmo1067.fasta	lmo1070.fasta	lmo1071.fasta	lmo1072.fasta	lmo1092.fasta	lmo1093.fasta	lmo1096.fasta	lmo1142.fasta	lmo1144.fasta	lmo1145.fasta	lmo1148.fasta	lmo1150.fasta	lmo1151.fasta	lmo1152.fasta	lmo1153.fasta	lmo1154.fasta	lmo1155.fasta	lmo1156.fasta	lmo1157.fasta	lmo1158.fasta	lmo1159.fasta	lmo1DB0.fasta	lmo1DB2.fasta	lmo1DB3.fasta	lmo1DB4.fasta	lmo1DB5.fasta	lmo1DB6.fasta	lmo1DB7.fasta	lmo1DB8.fasta	lmo1171.fasta	lmo1173.fasta	lmo1174.fasta	lmo1175.fasta	lmo1176.fasta	lmo1177.fasta	lmo1178.fasta	lmo1179.fasta	lmo1180.fasta	lmo1181.fasta	lmo1182.fasta	lmo1183.fasta	lmo1185.fasta	lmo1186.fasta	lmo1190.fasta	lmo1191.fasta	lmo1192.fasta	lmo1193.fasta	lmo1194.fasta	lmo1198.fasta	lmo1199.fasta	lmo1200.fasta	lmo1202.fasta	lmo1204.fasta	lmo1206.fasta	lmo1208.fasta	lmo1210.fasta	lmo1211.fasta	lmo12DB.fasta	lmo1217.fasta	lmo1218.fasta	lmo1219.fasta	lmo1220.fasta	lmo1221.fasta	lmo1222.fasta	lmo1223.fasta	lmo1225.fasta	lmo1226.fasta	lmo1227.fasta	lmo1228.fasta	lmo1229.fasta	lmo1230.fasta	lmo1231.fasta	lmo1232.fasta	lmo1233.fasta	lmo1234.fasta	lmo1235.fasta	lmo1236.fasta	lmo1237.fasta	lmo1238.fasta	lmo1239.fasta	lmo1240.fasta	lmo1241.fasta	lmo1244.fasta	lmo1245.fasta	lmo1246.fasta	lmo1247.fasta	lmo1249.fasta	lmo1250.fasta	lmo1251.fasta	lmo1252.fasta	lmo1253.fasta	lmo1254.fasta	lmo1255.fasta	lmo1267.fasta	lmo1268.fasta	lmo1269.fasta	lmo1271.fasta	lmo1272.fasta	lmo1275.fasta	lmo1277.fasta	lmo1278.fasta	lmo1279.fasta	lmo1280.fasta	lmo1281.fasta	lmo1282.fasta	lmo1283.fasta	lmo1284.fasta	lmo1285.fasta	lmo1286.fasta	lmo1287.fasta	lmo1293.fasta	lmo1295.fasta	lmo1298.fasta	lmo1299.fasta	lmo1302.fasta	lmo1305.fasta	lmo1306.fasta	lmo1313.fasta	lmo1314.fasta	lmo1315.fasta	lmo13DB.fasta	lmo1317.fasta	lmo1318.fasta	lmo1319.fasta	lmo1320.fasta	lmo1321.fasta	lmo1322.fasta	lmo1324.fasta	lmo1326.fasta	lmo1327.fasta	lmo1330.fasta	lmo1331.fasta	lmo1333.fasta	lmo1335.fasta	lmo1337.fasta	lmo1338.fasta	lmo1340.fasta	lmo1341.fasta	lmo1342.fasta	lmo1344.fasta	lmo1345.fasta	lmo1346.fasta	lmo1348.fasta	lmo1349.fasta	lmo1350.fasta	lmo1351.fasta	lmo1353.fasta	lmo1354.fasta	lmo1355.fasta	lmo1357.fasta	lmo1358.fasta	lmo1359.fasta	lmo1360.fasta	lmo1361.fasta	lmo1363.fasta	lmo1364.fasta	lmo1367.fasta	lmo1368.fasta	lmo1370.fasta	lmo1371.fasta	lmo1372.fasta	lmo1373.fasta	lmo1374.fasta	lmo1376.fasta	lmo1377.fasta	lmo1378.fasta	lmo1379.fasta	lmo1380.fasta	lmo1381.fasta	lmo1383.fasta	lmo1384.fasta	lmo1385.fasta	lmo1386.fasta	lmo1388.fasta	lmo1389.fasta	lmo1391.fasta	lmo1392.fasta	lmo1394.fasta	lmo1395.fasta	lmo1396.fasta	lmo1397.fasta	lmo1398.fasta	lmo1399.fasta	lmo1400.fasta	lmo1401.fasta	lmo1402.fasta	lmo1406.fasta	lmo1407.fasta	lmo1408.fasta	lmo1409.fasta	lmo1411.fasta	lmo1412.fasta	lmo1415.fasta	lmo14DB.fasta	lmo1417.fasta	lmo1419.fasta	lmo1420.fasta	lmo1421.fasta	lmo1422.fasta	lmo1423.fasta	lmo1424.fasta	lmo1425.fasta	lmo1426.fasta	lmo1427.fasta	lmo1428.fasta	lmo1431.fasta	lmo1434.fasta	lmo1435.fasta	lmo1437.fasta	lmo1438.fasta	lmo1439.fasta	lmo1440.fasta	lmo1444.fasta	lmo1446.fasta	lmo1448.fasta	lmo1450.fasta	lmo1452.fasta	lmo1454.fasta	lmo1455.fasta	lmo1456.fasta	lmo1457.fasta	lmo1462.fasta	lmo1463.fasta	lmo1465.fasta	lmo1466.fasta	lmo1467.fasta	lmo1468.fasta	lmo1469.fasta	lmo1472.fasta	lmo1473.fasta	lmo1474.fasta	lmo1475.fasta	lmo1476.fasta	lmo1479.fasta	lmo1480.fasta	lmo1481.fasta	lmo1482.fasta	lmo1483.fasta	lmo1485.fasta	lmo1486.fasta	lmo1487.fasta	lmo1489.fasta	lmo1490.fasta	lmo1491.fasta	lmo1492.fasta	lmo1493.fasta	lmo1494.fasta	lmo1495.fasta	lmo1496.fasta	lmo1497.fasta	lmo1498.fasta	lmo1499.fasta	lmo1500.fasta	lmo1502.fasta	lmo1503.fasta	lmo1504.fasta	lmo1507.fasta	lmo1509.fasta	lmo1510.fasta	lmo1511.fasta	lmo1512.fasta	lmo1518.fasta	lmo1519.fasta	lmo1520.fasta	lmo1521.fasta	lmo1523.fasta	lmo1525.fasta	lmo1526.fasta	lmo1527.fasta	lmo1528.fasta	lmo1529.fasta	lmo1530.fasta	lmo1531.fasta	lmo1532.fasta	lmo1533.fasta	lmo1534.fasta	lmo1535.fasta	lmo1536.fasta	lmo1537.fasta	lmo1538.fasta	lmo1539.fasta	lmo1540.fasta	lmo1541.fasta	lmo1542.fasta	lmo1544.fasta	lmo1545.fasta	lmo1546.fasta	lmo1547.fasta	lmo1548.fasta	lmo1557.fasta	lmo1558.fasta	lmo1559.fasta	lmo1560.fasta	lmo1561.fasta	lmo1562.fasta	lmo1563.fasta	lmo1564.fasta	lmo1565.fasta	lmo1566.fasta	lmo1567.fasta	lmo1568.fasta	lmo1569.fasta	lmo1570.fasta	lmo1571.fasta	lmo1572.fasta	lmo1576.fasta	lmo1577.fasta	lmo1578.fasta	lmo1579.fasta	lmo1580.fasta	lmo1581.fasta	lmo1582.fasta	lmo1583.fasta	lmo1585.fasta	lmo1586.fasta	lmo1588.fasta	lmo1590.fasta	lmo1591.fasta	lmo1592.fasta	lmo1593.fasta	lmo1594.fasta	lmo1595.fasta	lmo1596.fasta	lmo1598.fasta	lmo1599.fasta	lmoDB00.fasta	lmoDB01.fasta	lmoDB02.fasta	lmoDB03.fasta	lmoDB04.fasta	lmoDB05.fasta	lmoDB06.fasta	lmoDB09.fasta	lmoDB12.fasta	lmoDB15.fasta	lmoDBDB.fasta	lmoDB17.fasta	lmoDB18.fasta	lmoDB20.fasta	lmoDB21.fasta	lmoDB24.fasta	lmoDB25.fasta	lmoDB26.fasta	lmoDB28.fasta	lmoDB29.fasta	lmoDB30.fasta	lmoDB31.fasta	lmoDB34.fasta	lmoDB35.fasta	lmoDB36.fasta	lmoDB37.fasta	lmoDB38.fasta	lmoDB39.fasta	lmoDB41.fasta	lmoDB43.fasta	lmoDB44.fasta	lmoDB46.fasta	lmoDB47.fasta	lmoDB50.fasta	lmoDB51.fasta	lmoDB57.fasta	lmoDB58.fasta	lmoDB60.fasta	lmoDB61.fasta	lmoDB63.fasta	lmoDB65.fasta	lmoDB68.fasta	lmoDB73.fasta	lmoDB75.fasta	lmoDB76.fasta	lmoDB77.fasta	lmoDB78.fasta	lmoDB79.fasta	lmoDB82.fasta	lmoDB83.fasta	lmoDB85.fasta	lmoDB86.fasta	lmoDB87.fasta	lmoDB89.fasta	lmoDB90.fasta	lmoDB92.fasta	lmoDB94.fasta	lmoDB95.fasta	lmoDB96.fasta	lmoDB97.fasta	lmoDB98.fasta	lmoDB99.fasta	lmo1700.fasta	lmo1702.fasta	lmo1704.fasta	lmo1705.fasta	lmo1706.fasta	lmo1707.fasta	lmo1708.fasta	lmo1709.fasta	lmo1710.fasta	lmo1711.fasta	lmo1712.fasta	lmo1713.fasta	lmo1718.fasta	lmo1719.fasta	lmo1720.fasta	lmo1721.fasta	lmo1722.fasta	lmo1726.fasta	lmo1727.fasta	lmo1730.fasta	lmo1731.fasta	lmo1732.fasta	lmo1733.fasta	lmo1734.fasta	lmo1735.fasta	lmo1736.fasta	lmo1737.fasta	lmo1738.fasta	lmo1739.fasta	lmo1740.fasta	lmo1745.fasta	lmo1749.fasta	lmo1752.fasta	lmo1753.fasta	lmo1754.fasta	lmo1755.fasta	lmo1756.fasta	lmo1757.fasta	lmo1758.fasta	lmo1759.fasta	lmo1760.fasta	lmo1761.fasta	lmo1762.fasta	lmo1763.fasta	lmo1764.fasta	lmo1765.fasta	lmo1766.fasta	lmo1767.fasta	lmo1769.fasta	lmo1771.fasta	lmo1772.fasta	lmo1773.fasta	lmo1774.fasta	lmo1776.fasta	lmo1779.fasta	lmo1780.fasta	lmo1782.fasta	lmo1783.fasta	lmo1784.fasta	lmo1785.fasta	lmo1787.fasta	lmo1788.fasta	lmo1791.fasta	lmo1792.fasta	lmo1793.fasta	lmo1794.fasta	lmo1795.fasta	lmo1796.fasta	lmo1797.fasta	lmo1801.fasta	lmo1802.fasta	lmo1803.fasta	lmo1804.fasta	lmo1805.fasta	lmo1806.fasta	lmo1807.fasta	lmo1809.fasta	lmo1810.fasta	lmo1811.fasta	lmo1813.fasta	lmo1815.fasta	lmo18DB.fasta	lmo1818.fasta	lmo1819.fasta	lmo1820.fasta	lmo1821.fasta	lmo1822.fasta	lmo1823.fasta	lmo1824.fasta	lmo1825.fasta	lmo1826.fasta	lmo1827.fasta	lmo1828.fasta	lmo1830.fasta	lmo1833.fasta	lmo1834.fasta	lmo1835.fasta	lmo1837.fasta	lmo1839.fasta	lmo1840.fasta	lmo1841.fasta	lmo1844.fasta	lmo1845.fasta	lmo1848.fasta	lmo1850.fasta	lmo1851.fasta	lmo1852.fasta	lmo1853.fasta	lmo1854.fasta	lmo1856.fasta	lmo1857.fasta	lmo1858.fasta	lmo1859.fasta	lmo1860.fasta	lmo1861.fasta	lmo1862.fasta	lmo1863.fasta	lmo1864.fasta	lmo1866.fasta	lmo1867.fasta	lmo1868.fasta	lmo1869.fasta	lmo1870.fasta	lmo1871.fasta	lmo1872.fasta	lmo1873.fasta	lmo1874.fasta	lmo1875.fasta	lmo1878.fasta	lmo1879.fasta	lmo1880.fasta	lmo1881.fasta	lmo1882.fasta	lmo1883.fasta	lmo1884.fasta	lmo1885.fasta	lmo1886.fasta	lmo1887.fasta	lmo1888.fasta	lmo1890.fasta	lmo1891.fasta	lmo1892.fasta	lmo1894.fasta	lmo1895.fasta	lmo1896.fasta	lmo1897.fasta	lmo1898.fasta	lmo1899.fasta	lmo1900.fasta	lmo1902.fasta	lmo1903.fasta	lmo1907.fasta	lmo1911.fasta	lmo1912.fasta	lmo1915.fasta	lmo19DB.fasta	lmo1917.fasta	lmo1918.fasta	lmo1919.fasta	lmo1920.fasta	lmo1921.fasta	lmo1922.fasta	lmo1924.fasta	lmo1927.fasta	lmo1928.fasta	lmo1929.fasta	lmo1930.fasta	lmo1931.fasta	lmo1932.fasta	lmo1933.fasta	lmo1934.fasta	lmo1935.fasta	lmo1936.fasta	lmo1937.fasta	lmo1938.fasta	lmo1940.fasta	lmo1941.fasta	lmo1944.fasta	lmo1946.fasta	lmo1947.fasta	lmo1948.fasta	lmo1949.fasta	lmo1950.fasta	lmo1951.fasta	lmo1952.fasta	lmo1953.fasta	lmo1954.fasta	lmo1955.fasta	lmo1956.fasta	lmo1957.fasta	lmo1958.fasta	lmo1962.fasta	lmo1963.fasta	lmo1964.fasta	lmo1965.fasta	lmo1967.fasta	lmo1978.fasta	lmo1979.fasta	lmo1982.fasta	lmo1983.fasta	lmo1985.fasta	lmo1986.fasta	lmo1987.fasta	lmo1989.fasta	lmo1991.fasta	lmo1992.fasta	lmo1993.fasta	lmo1994.fasta	lmo1995.fasta	lmo1996.fasta	lmo1997.fasta	lmo1998.fasta	lmo1999.fasta	lmo2000.fasta	lmo2002.fasta	lmo2003.fasta	lmo2004.fasta	lmo2006.fasta	lmo2007.fasta	lmo2008.fasta	lmo2009.fasta	lmo2010.fasta	lmo2012.fasta	lmo2013.fasta	lmo2014.fasta	lmo2015.fasta	lmo20DB.fasta	lmo2017.fasta	lmo2019.fasta	lmo2020.fasta	lmo2028.fasta	lmo2029.fasta	lmo2030.fasta	lmo2031.fasta	lmo2034.fasta	lmo2035.fasta	lmo2036.fasta	lmo2037.fasta	lmo2040.fasta	lmo2041.fasta	lmo2042.fasta	lmo2047.fasta	lmo2048.fasta	lmo2049.fasta	lmo2050.fasta	lmo2051.fasta	lmo2052.fasta	lmo2053.fasta	lmo2054.fasta	lmo2055.fasta	lmo2056.fasta	lmo2057.fasta	lmo2058.fasta	lmo2059.fasta	lmo2060.fasta	lmo2061.fasta	lmo2062.fasta	lmo2063.fasta	lmo2064.fasta	lmo2065.fasta	lmo2067.fasta	lmo2068.fasta	lmo2069.fasta	lmo2070.fasta	lmo2071.fasta	lmo2072.fasta	lmo2075.fasta	lmo2076.fasta	lmo2083.fasta	lmo2084.fasta	lmo2088.fasta	lmo2089.fasta	lmo2090.fasta	lmo2091.fasta	lmo2092.fasta	lmo2093.fasta	lmo2094.fasta	lmo2095.fasta	lmo2096.fasta	lmo2097.fasta	lmo2098.fasta	lmo2099.fasta	lmo2101.fasta	lmo2103.fasta	lmo2104.fasta	lmo2111.fasta	lmo2112.fasta	lmo2113.fasta	lmo2118.fasta	lmo2119.fasta	lmo2120.fasta	lmo2122.fasta	lmo2123.fasta	lmo2124.fasta	lmo2125.fasta	lmo2126.fasta	lmo2130.fasta	lmo2141.fasta	lmo2142.fasta	lmo2145.fasta	lmo2152.fasta	lmo2153.fasta	lmo2154.fasta	lmo2155.fasta	lmo2156.fasta	lmo2158.fasta	lmo2159.fasta	lmo2DB0.fasta	lmo2DB1.fasta	lmo2DB2.fasta	lmo2DB3.fasta	lmo2DB4.fasta	lmo2DB5.fasta	lmo2DB6.fasta	lmo2DB7.fasta	lmo2DB8.fasta	lmo2170.fasta	lmo2171.fasta	lmo2172.fasta	lmo2173.fasta	lmo2188.fasta	lmo2190.fasta	lmo2191.fasta	lmo2192.fasta	lmo2193.fasta	lmo2194.fasta	lmo2195.fasta	lmo2196.fasta	lmo2198.fasta	lmo2200.fasta	lmo2201.fasta	lmo2202.fasta	lmo2203.fasta	lmo2204.fasta	lmo2205.fasta	lmo2206.fasta	lmo2207.fasta	lmo2208.fasta	lmo2210.fasta	lmo2211.fasta	lmo2212.fasta	lmo2213.fasta	lmo2214.fasta	lmo22DB.fasta	lmo2217.fasta	lmo2218.fasta	lmo2219.fasta	lmo2220.fasta	lmo2223.fasta	lmo2225.fasta	lmo2227.fasta	lmo2229.fasta	lmo2230.fasta	lmo2232.fasta	lmo2233.fasta	lmo2234.fasta	lmo2235.fasta	lmo2236.fasta	lmo2237.fasta	lmo2238.fasta	lmo2244.fasta	lmo2246.fasta	lmo2247.fasta	lmo2248.fasta	lmo2249.fasta	lmo2250.fasta	lmo2252.fasta	lmo2253.fasta	lmo2254.fasta	lmo2255.fasta	lmo2256.fasta	lmo2258.fasta	lmo2261.fasta	lmo2262.fasta	lmo2263.fasta	lmo2264.fasta	lmo2265.fasta	lmo2334.fasta	lmo2336.fasta	lmo2337.fasta	lmo2338.fasta	lmo2340.fasta	lmo2341.fasta	lmo2345.fasta	lmo2346.fasta	lmo2347.fasta	lmo2348.fasta	lmo2349.fasta	lmo2350.fasta	lmo2351.fasta	lmo2352.fasta	lmo2353.fasta	lmo2354.fasta	lmo2355.fasta	lmo2358.fasta	lmo2360.fasta	lmo2361.fasta	lmo2362.fasta	lmo2363.fasta	lmo2366.fasta	lmo2367.fasta	lmo2368.fasta	lmo2369.fasta	lmo2370.fasta	lmo2371.fasta	lmo2372.fasta	lmo2373.fasta	lmo2374.fasta	lmo2376.fasta	lmo2378.fasta	lmo2381.fasta	lmo2382.fasta	lmo2384.fasta	lmo2386.fasta	lmo2389.fasta	lmo2390.fasta	lmo2391.fasta	lmo2392.fasta	lmo2393.fasta	lmo2397.fasta	lmo2398.fasta	lmo2399.fasta	lmo2401.fasta	lmo2402.fasta	lmo2404.fasta	lmo2405.fasta	lmo2406.fasta	lmo2411.fasta	lmo2412.fasta	lmo2413.fasta	lmo2414.fasta	lmo2415.fasta	lmo2417.fasta	lmo2418.fasta	lmo2419.fasta	lmo2420.fasta	lmo2421.fasta	lmo2423.fasta	lmo2425.fasta	lmo2426.fasta	lmo2427.fasta	lmo2428.fasta	lmo2429.fasta	lmo2430.fasta	lmo2431.fasta	lmo2432.fasta	lmo2433.fasta	lmo2434.fasta	lmo2436.fasta	lmo2437.fasta	lmo2441.fasta	lmo2448.fasta	lmo2449.fasta	lmo2450.fasta	lmo2451.fasta	lmo2452.fasta	lmo2453.fasta	lmo2454.fasta	lmo2455.fasta	lmo2456.fasta	lmo2457.fasta	lmo2458.fasta	lmo2459.fasta	lmo2460.fasta	lmo2462.fasta	lmo2465.fasta	lmo2468.fasta	lmo2471.fasta	lmo2472.fasta	lmo2473.fasta	lmo2474.fasta	lmo2475.fasta	lmo2477.fasta	lmo2478.fasta	lmo2479.fasta	lmo2480.fasta	lmo2481.fasta	lmo2482.fasta	lmo2483.fasta	lmo2484.fasta	lmo2486.fasta	lmo2487.fasta	lmo2488.fasta	lmo2489.fasta	lmo2490.fasta	lmo2491.fasta	lmo2492.fasta	lmo2493.fasta	lmo2494.fasta	lmo2496.fasta	lmo2497.fasta	lmo2498.fasta	lmo2499.fasta	lmo2501.fasta	lmo2503.fasta	lmo2504.fasta	lmo2505.fasta	lmo2506.fasta	lmo2509.fasta	lmo2510.fasta	lmo2511.fasta	lmo2514.fasta	lmo2515.fasta	lmo25DB.fasta	lmo2518.fasta	lmo2524.fasta	lmo2525.fasta	lmo2526.fasta	lmo2527.fasta	lmo2528.fasta	lmo2529.fasta	lmo2530.fasta	lmo2531.fasta	lmo2532.fasta	lmo2533.fasta	lmo2534.fasta	lmo2535.fasta	lmo2536.fasta	lmo2537.fasta	lmo2538.fasta	lmo2539.fasta	lmo2543.fasta	lmo2544.fasta	lmo2545.fasta	lmo2546.fasta	lmo2547.fasta	lmo2548.fasta	lmo2555.fasta	lmo2556.fasta	lmo2559.fasta	lmo2560.fasta	lmo2561.fasta	lmo2562.fasta	lmo2564.fasta	lmo2566.fasta	lmo2567.fasta	lmo2568.fasta	lmo2569.fasta	lmo2570.fasta	lmo2571.fasta	lmo2572.fasta	lmo2574.fasta	lmo2575.fasta	lmo2581.fasta	lmo2582.fasta	lmo2583.fasta	lmo2584.fasta	lmo2585.fasta	lmo2586.fasta	lmo2588.fasta	lmo2596.fasta	lmo2597.fasta	lmo2598.fasta	lmo2599.fasta	lmo2600.fasta	lmo2605.fasta	lmo2606.fasta	lmo2607.fasta	lmo2608.fasta	lmo2609.fasta	lmo2610.fasta	lmo2611.fasta	lmo2612.fasta	lmo2613.fasta	lmo2614.fasta	lmo2615.fasta	lmo26DB.fasta	lmo2617.fasta	lmo2618.fasta	lmo2619.fasta	lmo2620.fasta	lmo2621.fasta	lmo2622.fasta	lmo2623.fasta	lmo2625.fasta	lmo2626.fasta	lmo2627.fasta	lmo2628.fasta	lmo2629.fasta	lmo2630.fasta	lmo2631.fasta	lmo2632.fasta	lmo2633.fasta	lmo2634.fasta	lmo2636.fasta	lmo2637.fasta	lmo2638.fasta	lmo2639.fasta	lmo2640.fasta	lmo2641.fasta	lmo2642.fasta	lmo2643.fasta	lmo2644a.fasta	lmo2648.fasta	lmo2649.fasta	lmo2650.fasta	lmo2651.fasta	lmo2653.fasta	lmo2654.fasta	lmo2655.fasta	lmo2656.fasta	lmo2657.fasta	lmo2658.fasta	lmo2659.fasta	lmo2660.fasta	lmo2661.fasta	lmo2662.fasta	lmo2663.fasta	lmo2664.fasta	lmo2665.fasta	lmo2666.fasta	lmo2667.fasta	lmo2668.fasta	lmo2669.fasta	lmo2670.fasta	lmo2673.fasta	lmo2674.fasta	lmo2677.fasta	lmo2678.fasta	lmo2680.fasta	lmo2681.fasta	lmo2682.fasta	lmo2683.fasta	lmo2685.fasta	lmo2692.fasta	lmo2693.fasta	lmo2694.fasta	lmo2695.fasta	lmo2697.fasta	lmo2698.fasta	lmo2699.fasta	lmo2700.fasta	lmo2701.fasta	lmo2702.fasta	lmo2703.fasta	lmo2704.fasta	lmo2706.fasta	lmo2707.fasta	lmo2708.fasta	lmo2710.fasta	lmo2712.fasta	lmo2713.fasta	lmo27DB.fasta	lmo2718.fasta	lmo2719.fasta	lmo2720.fasta	lmo2721.fasta	lmo2722.fasta	lmo2723.fasta	lmo2724.fasta	lmo2725.fasta	lmo2726.fasta	lmo2727.fasta	lmo2730.fasta	lmo2738.fasta	lmo2741.fasta	lmo2742.fasta	lmo2743.fasta	lmo2744.fasta	lmo2745.fasta	lmo2746.fasta	lmo2747.fasta	lmo2751.fasta	lmo2752.fasta	lmo2754.fasta	lmo2755.fasta	lmo2756.fasta	lmo2757.fasta	lmo2758.fasta	lmo2759.fasta	lmo2761.fasta	lmo2762.fasta	lmo2763.fasta	lmo2764.fasta	lmo2766.fasta	lmo2767.fasta	lmo2769.fasta	lmo2770.fasta	lmo2779.fasta	lmo2785.fasta	lmo2789.fasta	lmo2790.fasta	lmo2792.fasta	lmo2793.fasta	lmo2794.fasta	lmo2796.fasta	lmo2797.fasta	lmo2798.fasta	lmo2799.fasta	lmo2800.fasta	lmo2801.fasta	lmo2802.fasta	lmo2810.fasta	lmo2819.fasta	lmo2822.fasta	lmo2823.fasta	lmo2824.fasta	lmo2826.fasta	lmo2829.fasta	lmo2830.fasta	lmo2831.fasta	lmo2832.fasta	lmo2833.fasta	lmo2834.fasta	lmo2835.fasta	lmo2836.fasta	lmo2838.fasta	lmo2839.fasta	lmo2842.fasta	lmo2853.fasta	lmo2854.fasta	lmo2855.fasta	lmo2856.fasta	lmo2857.fasta\n" > {output.profiles}
        """


#TODO
rule mongo_pull_timestamps:
    output:
        timestamps="db_data/{species}/timestamps.tsv",
    params:
        organism=lambda w: w.species,
    shell:
        """
        echo "sample\tdate\n" > {output.timestamps}
        """


#TODO
rule mongo_pull_statistics:
    output:
        timestamps="db_data/{species}/statistics.tsv",
    params:
        organism=lambda w: w.species,
    shell:
        """
        echo "sample\tEXC\tINF\tLNF\tPLOT\tNIPH\tALM\tASM\n" > {output.timestamps}
        """


rule make_isolate_sheet:
    # Can be expanded to included eg bakcharak results
    input:
        validation="validation/staging/isolates_sheets/{isolate}.json",
        calling="call_and_cluster/staging/isolates_sheets/{isolate}.json",
    output:
        isolate_sheet="staging/isolates_sheets/{isolate}.json",
    message:
        "[Database operations] Creating isolate sheet"
    conda:
        "../envs/pandas.yaml"
    log:
        "logs/make_isolate_sheet_{isolate}.log",
    script:
        "../scripts/make_isolate_sheet.py"


#TODO
rule mongo_push_clusters:
    input:
        clusters=aggregate_clusters,
    output:
        flag=touch("dbops/push_clusters.flag"),
    run:
        pass


#TODO
rule mongo_push_isolate:
    input:
        isolates=aggregate_isolate_sheets,
    output:
        flag=touch("dbops/push_isolates.flag"),
    run:
        pass


